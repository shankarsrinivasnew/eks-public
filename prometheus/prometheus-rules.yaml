additionalPrometheusRulesMap:
  tsb-cb-down-alerts-rules:
    groups:
    -   name: CB_APPS_DOWN_STATE

    ###########################################CB_APP_DOWN_WARNING##########################################################
        rules:
        -   record: cb_app_down_warning_prod
            expr: (kube_deployment_status_replicas_available{deployment=~"tsb-cb-ads-customer-lookup-topology|tsb-cb-authentication-api|tsb-cb-cdc-customer-data|tsb-cb-enrich|tsb-cb-fulfill|tsb-cb-hmac-generation-topology|tsb-cb-nlp-handler|tsb-cb-spring-api-gateway",namespace="cb"})

        -   alert: CB_app_down_warning_alert_prod
            expr: (cb_app_down_warning_prod) < 3
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: WARNING
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: '{{ $labels.deployment }} of job {{ $labels.job }} has less than 3 pods for more than 1 min. Value:{{ $value }}'
                summary: Warning Alert deployment {{ $labels.deployment }} of job {{ $labels.job }} has less than 3 pods running

    ###########################################CB_APP_DOWN_CRITICAL##########################################################

        -   record: cb_app_down_critical_prod
            expr: (kube_deployment_status_replicas_available{deployment=~".*tsb-cb.*",namespace="cb"})

        -   alert: CB_app_down_critical_alert_prod
            expr: (cb_app_down_critical_prod) < 1
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: '{{ $labels.deployment }} of job {{ $labels.job }} has no pods running. Value:{{ $value }}'
                summary: Critical deployment {{ $labels.deployment }} of job {{ $labels.job }} has no pods running


  tsb-cb-responsetime-alerts-rules:
    groups:
    -   name: CB_APP_RESPONSE_TIME

        rules:
        -   record: cb_app_auth_response_time_prod
            expr: sum by (namespace, job)(rate(http_server_requests_seconds_sum {namespace="cb",uri=~".*enrol.*|.*verify.*"}[5m]))/ sum by (namespace, job)(rate(http_server_requests_seconds_count{namespace="cb",uri=~".*enrol.*|.*verify.*"}[5m]))

        -   alert: CB_app_auth_response_time_green_alert_prod
            expr: (cb_app_auth_response_time_prod) > 1
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} response time is more than 1s for last 5 mins. Value: {{ $value }}'
                summary: Green alert for reponse time reached for Application {{ $labels.job }}

        -   alert: CB_app_auth_response_time_yellow_alert_prod
            expr: (cb_app_auth_response_time_prod) > 1.5
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} response time is more than 1.5s for last 5 mins. Value: {{ $value }}'
                summary: Yellow alert for reponse time reached for Application {{ $labels.job }}

        -   alert: CB_app_auth_response_time_red_alert_prod
            expr: (cb_app_auth_response_time_prod) > 2
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} response time is more than 2s for last 5 mins. Value: {{ $value }}'
                summary: Red alert for reponse time reached for Application {{ $labels.job }}

  tsb-cb-up-alerts-rules:
    groups:
    -   name: CB_APPS_UP_STATE

    ###########################################CB_AUTH_VERIFY##########################################################
        rules:
        -   record: cb_authentication_verify_up_prod
            expr: (sum by (job, namespace, uri) (rate(http_server_requests_seconds_count {namespace="cb",uri=~".*verify.*"}[5m]))*60)

        -   alert: CB_authentication_verify_up_green_alert_prod
            expr: (cb_authentication_verify_up_prod) > 7
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} has reached peak rate of 7 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }} Endpoint {{$labels.uri}}

        -   alert: CB_authentication_verify_up_yellow_alert_prod
            expr: (cb_authentication_verify_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }} Endpoint {{$labels.uri}}

        -   alert: CB_authentication_verify_up_red_alert_prod
            expr: (cb_authentication_verify_up_prod) > 150
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} has reached peak rate of 150 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }} Endpoint {{$labels.uri}}

        -   alert: CB_authentication_verify_up_critical_alert_prod
            expr: (cb_authentication_verify_up_prod) > 150
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} is at peak rate of 150 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }} Endpoint {{$labels.uri}}

    ###########################################CB_AUTH_ENROL##########################################################

        -   record: cb_authentication_enrol_up_prod
            expr: (sum by (job, namespace, uri) (rate(http_server_requests_seconds_count {namespace="cb",uri=~".*enrol.*"}[5m]))*60)

        -   alert: CB_authentication_enrol_up_green_alert_prod
            expr: (cb_authentication_enrol_up_prod) > 900
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} has reached peak rate of 900 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }} Endpoint {{$labels.uri}}

        -   alert: CB_authentication_enrol_up_yellow_alert_prod
            expr: (cb_authentication_enrol_up_prod) > 1320
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} has reached peak rate of 1320 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }} Endpoint {{$labels.uri}}

        -   alert: CB_authentication_enrol_up_red_alert_prod
            expr: (cb_authentication_enrol_up_prod) > 3364
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} has reached peak rate of 3364 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }} Endpoint {{$labels.uri}}

        -   alert: CB_authentication_enrol_up_critical_alert_prod
            expr: (cb_authentication_enrol_up_prod) > 3364
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.uri}} is at peak rate of 3364 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }} Endpoint {{$labels.uri}}

    ###########################################CB_CDC_CUSTOMER_DATA##########################################################

        -   record: cb_cdc_customer_data_up_prod
            expr: (sum by (job, namespace) (processHmacsStream_applicationId_consumer_fetch_manager_metrics_records_consumed_rate {namespace="cb"})*60)

        -   alert: CB_cdc_customer_data_up_green_alert_prod
            expr: (cb_cdc_customer_data_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_cdc_customer_data_up_yellow_alert_prod
            expr: (cb_cdc_customer_data_up_prod) > 30
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 30 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_cdc_customer_data_up_red_alert_prod
            expr: (cb_cdc_customer_data_up_prod) > 300
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 300 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_cdc_customer_data_up_critical_alert_prod
            expr: (cb_cdc_customer_data_up_prod) > 300
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 300 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}

    ###########################################CB_ENRICH_SUB_TOPOLOGY###########################################################

        -   record: cb_enrich_up_prod
            expr: (sum by (job, namespace) (consumer_fetch_manager_metrics_records_consumed_rate {namespace="cb",job="tsb-cb-enrich"})*60)

        -   alert: CB_enrich_up_green_alert_prod
            expr: (cb_enrich_up_prod) > 7
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 7 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_enrich_up_yellow_alert_prod
            expr: (cb_enrich_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_enrich_up_red_alert_prod
            expr: (cb_enrich_up_prod) > 150
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 150 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_enrich_up_critical_alert_prod
            expr: (cb_enrich_up_prod) > 150
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 150 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}

    ###########################################CB_FULFILL_SUB_TOPOLOGY###########################################################

        -   record: cb_fulfill_up_prod
            expr: (sum by (job, namespace) (consumer_fetch_manager_metrics_records_consumed_rate {namespace="cb",job="tsb-cb-fulfill"})*60)

        -   alert: CB_fulfill_up_green_alert_prod
            expr: (cb_fulfill_up_prod) > 7
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 7 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_fulfill_up_yellow_alert_prod
            expr: (cb_fulfill_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_fulfill_up_red_alert_prod
            expr: (cb_fulfill_up_prod) > 150
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 150 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_fulfill_up_critical_alert_prod
            expr: (cb_fulfill_up_prod) > 150
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 150 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}

    ###########################################CB_HMAC_GENERATION_TOPOLOGY###########################################################

        -   record: cb_hmac_generation_topology_up_prod
            expr: (sum by (job, namespace) (processHmacGenerationRequest_applicationId_consumer_fetch_manager_metrics_records_consumed_rate {namespace="cb"})*60)

        -   alert: CB_hmac_generation_topology_up_green_alert_prod
            expr: (cb_hmac_generation_topology_up_prod) > 900
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 900 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_hmac_generation_topology_up_yellow_alert_prod
            expr: (cb_hmac_generation_topology_up_prod) > 1320
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 1320 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_hmac_generation_topology_up_red_alert_prod
            expr: (cb_hmac_generation_topology_up_prod) > 3364
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 3364 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_hmac_generation_topology_up_critical_alert_prod
            expr: (cb_hmac_generation_topology_up_prod) > 3364
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 3364 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}

    ###########################################CB_LIVE_PERSON_ADAPTER###########################################################

        -   record: cb_lp_adapter_up_prod
            expr: (sum by (job, namespace) (rate(lp_adapter_rdkafka_topic_partition_msgs {namespace="cb"}[5m]))*60)

        -   alert: CB_lp_adapter_up_green_alert_prod
            expr: (cb_lp_adapter_up_prod) > 7
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 7 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_lp_adapter_up_yellow_alert_prod
            expr: (cb_lp_adapter_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_lp_adapter_up_red_alert_prod
            expr: (cb_lp_adapter_up_prod) > 150
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 150 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_lp_adapter_up_critical_alert_prod
            expr: (cb_lp_adapter_up_prod) > 150
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 150 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}

    ###########################################CB_NATURAL_LANGUAGE_PROCESS_HANDLER###########################################################

        -   record: cb_nlp_handler_up_prod
            expr: (sum by (job, namespace) (rate(spring_kafka_listener_seconds_count {namespace="cb"}[5m]))*60)

        -   alert: CB_nlp_handler_up_green_alert_prod
            expr: (cb_nlp_handler_up_prod) > 7
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 7 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_nlp_handler_up_yellow_alert_prod
            expr: (cb_nlp_handler_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_nlp_handler_up_red_alert_prod
            expr: (cb_nlp_handler_up_prod) > 150
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 150 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_nlp_handler_up_critical_alert_prod
            expr: (cb_nlp_handler_up_prod) > 150
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 150 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}

    ###########################################CB_SPRING_CLOUD_API_GW_VERIFY###########################################################

        -   record: cb_spring_api_gateway_verify_up_prod
            expr: (sum by (job, namespace, routeId)(rate(gateway_requests_seconds_count{ namespace="cb", routeId=~".*verify.*"}[5m]))*60)

        -   alert: CB_spring_api_gateway_verify_up_green_alert_prod
            expr: (cb_spring_api_gateway_verify_up_prod) > 7
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} has reached peak rate of 7 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

        -   alert: CB_spring_api_gateway_verify_up_yellow_alert_prod
            expr: (cb_spring_api_gateway_verify_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

        -   alert: CB_spring_api_gateway_verify_up_red_alert_prod
            expr: (cb_spring_api_gateway_verify_up_prod) > 150
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} has reached peak rate of 150 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

        -   alert: CB_spring_api_gateway_verify_up_critical_alert_prod
            expr: (cb_spring_api_gateway_verify_up_prod) > 150
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} is at peak rate of 150 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

    ###########################################CB_SPRING_CLOUD_API_GW_ENROL###########################################################

        -   record: cb_spring_api_gateway_enrol_up_prod
            expr: (sum by (job, namespace, routeId)(rate(gateway_requests_seconds_count{ namespace="cb", routeId=~".*enrol.*"}[5m]))*60)

        -   alert: CB_spring_api_gateway_enrol_up_green_alert_prod
            expr: (cb_spring_api_gateway_enrol_up_prod) > 900
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} has reached peak rate of 900 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

        -   alert: CB_spring_api_gateway_enrol_up_yellow_alert_prod
            expr: (cb_spring_api_gateway_enrol_up_prod) > 1320
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} has reached peak rate of 1320 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

        -   alert: CB_spring_api_gateway_enrol_up_red_alert_prod
            expr: (cb_spring_api_gateway_enrol_up_prod) > 3364
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} has reached peak rate of 3364 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

        -   alert: CB_spring_api_gateway_enrol_up_critical_alert_prod
            expr: (cb_spring_api_gateway_enrol_up_prod) > 3364
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} Endpoint {{$labels.routeId}} is at peak rate of 3364 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }} Endpoint {{$labels.routeId}}

    ###########################################CB_ADS_CUSTOMER_LOOKUP_TOPOLOGY###########################################################

        -   record: cb_ads_customer_lookup_up_prod
            expr: (sum by (job, namespace) (tsb_cb_ads_customer_lookup_topology_consumer_fetch_manager_metrics_records_consumed_rate or processCustomerLookupByUserId_applicationId_consumer_fetch_manager_metrics_records_consumed_rate)*60)

        -   alert: CB_ads_customer_lookup_up_green_alert_prod
            expr: (cb_ads_customer_lookup_up_prod) > 15
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: GREEN
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 15 in 1 min. Value: {{ $value }}'
                summary: Green rate reached for Application {{ $labels.job }}

        -   alert: CB_ads_customer_lookup_up_yellow_alert_prod
            expr: (cb_ads_customer_lookup_up_prod) > 30
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: YELLOW
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 30 in 1 min. Value: {{ $value }}'
                summary: Yellow rate reached for Application {{ $labels.job }}

        -   alert: CB_ads_customer_lookup_up_red_alert_prod
            expr: (cb_ads_customer_lookup_up_prod) > 300
            for: 1m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: RED
                platform: AWS
                namespace: cb
                severity: WARNING
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} has reached peak rate of 300 in 1 min. Value: {{ $value }}'
                summary: Red rate reached for Application {{ $labels.job }}

        -   alert: CB_ads_customer_lookup_up_critical_alert_prod
            expr: (cb_ads_customer_lookup_up_prod) > 300
            for: 5m
            labels:
                action: NO LLAMAR A GUARDIA
                environment: prod
                group: INFRA
                level: CRITICAL
                platform: AWS
                namespace: cb
                severity: CRITICAL
                type: 8x5
            annotations:
                description: 'Application {{ $labels.job }} is at peak rate of 300 for last 5 mins. Value: {{ $value }}'
                summary: Critical Alert for Application {{ $labels.job }}
