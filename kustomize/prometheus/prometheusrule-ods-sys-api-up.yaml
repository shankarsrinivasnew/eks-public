apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  labels:
    app: kube-prometheus-stack
    release: prometheus
  name: ods-sys-api-up-alerts
  namespace: prometheus
spec:
  groups:
    - name: ODS_SYS_API_APPS_UP_STATE
      rules:
  ###########################################ODS_SYS_API_BS01_500 STATUS ERROR##########################################################
        - record: ods_sys_api_bs01_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-bs01-corporate-information",namespace="ods"}[5m])))
        - alert: ods_sys_api_bs01_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_bs01_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_bs01_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_bs01_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}      
    ###########################################ODS_SYS_API_BS46_500 STATUS ERROR##########################################################
        - record: ods_sys_api_bs46_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-bs46-transaction-type",namespace="ods"}[5m])))
        - alert: ods_sys_api_bs46_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_bs46_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_bs46_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_bs46_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}      
    ###########################################ODS_SYS_API_BS95_500 STATUS ERROR##########################################################
        - record: ods_sys_api_bs95_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-bs95-product",namespace="ods"}[5m])))
        - alert: ods_sys_api_bs95_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_bs95_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_bs95_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_bs95_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}      
    ###########################################ODS_SYS_API_DP01_500 STATUS ERROR##########################################################
        - record: ods_sys_api_dp01_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-dp01-product",namespace="ods"}[5m])))
        - alert: ods_sys_api_dp01_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_dp01_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_dp01_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_dp01_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}      
    ###########################################ODS_SYS_API_DV01_500 STATUS ERROR##########################################################
        - record: ods_sys_api_dv01_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-dv01-account",namespace="ods"}[5m])))
        - alert: ods_sys_api_dv01_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_dv01_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_dv01_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_dv01_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}              
    ###########################################ODS_SYS_API_KC03_500 STATUS ERROR##########################################################
        - record: ods_sys_api_kc03_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job=~"tsb-ods-sys-api-kc03-transaction",namespace="ods"}[5m])))
        - alert: ods_sys_api_kc03_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_kc03_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_kc03_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_kc03_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }} 
    ###########################################ODS_SYS_API_KC13_500 STATUS ERROR##########################################################
        - record: ods_sys_api_kc13_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-kc13-pending-transaction",namespace="ods"}[5m])))
        - alert: ods_sys_api_kc13_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_kc13_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_kc13_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_kc13_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }} 
    ###########################################ODS_SYS_API_KC43_500 STATUS ERROR##########################################################
        - record: ods_sys_api_kc43_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-kc43-transaction",namespace="ods"}[5m])))
        - alert: ods_sys_api_kc43_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_kc43_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_kc43_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_kc43_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE06_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe06_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe06-contract",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe06_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe06_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe06_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe06_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE09_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe09_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe09-addresses",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe09_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe09_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe09_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe09_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE10_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe10_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe10-business-customer",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe10_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe10_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe10_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe10_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE11_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe11_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe11-customer",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe11_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe11_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe11_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe11_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE16_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe16_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe16-person-contract",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe16_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe16_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe16_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe16_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE17_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe17_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe17-customer-addresses-link",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe17_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe17_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe17_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe17_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PE34_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pe34_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pe34-customer-contact",namespace="ods"}[5m])))
        - alert: ods_sys_api_pe34_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe34_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pe34_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pe34_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SYS_API_PEA6_500 STATUS ERROR##########################################################
        - record: ods_sys_api_pea6_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-sys-api-pea6-addresses-history",namespace="ods"}[5m])))
        - alert: ods_sys_api_pea6_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pea6_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sys_api_pea6_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sys_api_pea6_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###################################ODS_SUB_API_ACCOUNT_TRANSACTION_500 STATUS ERROR##################################################
        - record: ods_sub_api_account_transaction_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-account-transaction",namespace="ods"}[5m])))
        - alert: ods_sub_api_account_transaction_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_account_transaction_500_status_{{ AWS_ENVIRONMENT }}) > 10
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_account_transaction_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_account_transaction_500_status_{{ AWS_ENVIRONMENT }}) > 25
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: CRITICAL
            platform: AWS
            namespace: ods
            severity: CRITICAL
            type: 8x5
            tsbci: ODS_AWS
#             itopsbridge: true
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}      
    ###########################################ODS_SUB_API_COBOL_KC7961_500 STATUS ERROR#################################################
        - record: ods_sub_api_cobol_kc7961_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-cobol-kc7961-transaction",namespace="ods"}[5m])))
        - alert: ods_sub_api_cobol_kc7961_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cobol_kc7961_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_cobol_kc7961_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cobol_kc7961_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###########################################ODS_SUB_API_COBOL_SEARCH_500 STATUS ERROR#################################################
        - record: ods_sub_api_cobol_search_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-cobol-search-transaction",namespace="ods"}[5m])))
        - alert: ods_sub_api_cobol_search_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cobol_search_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_cobol_search_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cobol_search_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}   
    ###################################ODS_SUB_API_PRODUCT_DETAILS_500 STATUS ERROR##################################################
        - record: ods_sub_api_product_details_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-product-details",namespace="ods"}[5m])))
        - alert: ods_sub_api_product_details_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_product_details_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_product_details_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_product_details_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}         
    ###################################ODS_SUB_API_MORTGAGE_TRANSACTION_500 STATUS ERROR##################################################
        - record: ods_sub_api_mortgage_transaction_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-mortgage-transaction",namespace="ods"}[5m])))
        - alert: ods_sub_api_mortgage_transaction_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_mortgage_transaction_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_mortgage_transaction_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_mortgage_transaction_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###################################ODS_SUB_API_LOAN_TRANSACTION_500 STATUS ERROR##################################################
        - record: ods_sub_api_loan_transaction_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-loan-transaction",namespace="ods"}[5m])))
        - alert: ods_sub_api_loan_transaction_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_loan_transaction_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_loan_transaction_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_loan_transaction_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}
    ###################################ODS_SUB_API_CUSTOMER_DETAILS_500 STATUS ERROR##################################################
        - record: ods_sub_api_customer_details_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-customer-details",namespace="ods"}[5m])))
        - alert: ods_sub_api_customer_details_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_customer_details_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_customer_details_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_customer_details_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}            
    ###################################ODS_SUB_API_CUSTOMER_SEARCH_500 STATUS ERROR##################################################
        - record: ods_sub_api_customer_search_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-customer-search",namespace="ods"}[5m])))
        - alert: ods_sub_api_customer_search_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_customer_search_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_customer_search_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_customer_search_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}                        
    ###################################ODS_SUB_API_PLASTIC_CARD_DETAILS_500 STATUS ERROR##################################################
        - record: ods_sub_api_plastic_card_details_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-plasticcard-details",namespace="ods"}[5m])))
        - alert: ods_sub_api_plastic_card_details_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_plastic_card_details_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_plastic_card_details_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_plastic_card_details_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: RED
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}            
    ###################################ODS_API_CLI_CUSTOMER_SEARCH_500 STATUS ERROR##################################################
        - record: ods_sub_api_cli_customer_search_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-cli-customer-search",namespace="ods"}[5m])))
        - alert: ods_sub_api_cli_customer_search_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cli_customer_search_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_cli_customer_search_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cli_customer_search_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: CRITICAL
            platform: AWS
            namespace: ods
            severity: CRITICAL
            type: 8x5
            tsbci: ODS_AWS
#             itopsbridge: true
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}                                    
    ###################################ODS_API_COP_CUSTOMER_SEARCH_500 STATUS ERROR##################################################
        - record: ods_sub_api_cop_customer_search_500_status_{{ AWS_ENVIRONMENT }}
          expr: (sum by (job, namespace) (increase(http_server_requests_seconds_count{status="500",job="tsb-ods-api-cop-customer-search",namespace="ods"}[5m])))
        - alert: ods_sub_api_cop_customer_search_500_status_yellow_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cop_customer_search_500_status_{{ AWS_ENVIRONMENT }}) > 5
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: YELLOW
            platform: AWS
            namespace: ods
            severity: WARNING
            type: 8x5
            tsbci: ODS_AWS
          annotations:
            description: 'Application {{ $labels.job }} has more than 5 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Yellow rate reached for Application {{ $labels.job }}            
        - alert: ods_sub_api_cop_customer_search_500_status_red_alert_{{ AWS_ENVIRONMENT }}
          expr: (ods_sub_api_cop_customer_search_500_status_{{ AWS_ENVIRONMENT }}) > 15
          for: 5m
          labels:
            action: Closely monitor
            environment: "{{ AWS_ENVIRONMENT }}"
            group: INFRA
            level: CRITICAL
            platform: AWS
            namespace: ods
            severity: CRITICAL
            type: 8x5
            tsbci: ODS_AWS
#             itopsbridge: true
          annotations:
            description: 'Application {{ $labels.job }} has more than 15 failures in the last 5 mins (500 Internal Server Error). Value: {{ $value }}'
            summary: Red rate reached for Application {{ $labels.job }}                                                
